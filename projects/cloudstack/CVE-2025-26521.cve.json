{
  "containers": {
    "cna": {
      "providerMetadata": {
        "orgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09"
      },
      "title": "CKS cluster in project exposes user API keys",
      "problemTypes": [
        {
          "descriptions": [
            {
              "description": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor",
              "lang": "en",
              "cweId": "CWE-200",
              "type": "CWE"
            }
          ]
        }
      ],
      "source": {
        "discovery": "UNKNOWN"
      },
      "affected": [
        {
          "vendor": "Apache Software Foundation",
          "product": "Apache CloudStack",
          "versions": [
            {
              "status": "affected",
              "version": "4.17.0.0",
              "lessThan": "4.19.3.0",
              "versionType": "semver"
            },
            {
              "status": "affected",
              "version": "4.20.0.0",
              "lessThan": "4.20.1.0",
              "versionType": "semver"
            }
          ],
          "defaultStatus": "unaffected"
        }
      ],
      "descriptions": [
        {
          "value": "When an Apache CloudStack user-account creates a CKS-based Kubernetes cluster in a project, the API key and the secret key of the 'kubeadmin' user of the caller account are used to create the secret config in the CKS-based Kubernetes cluster. A member of the project who can access the CKS-based Kubernetes cluster, can also access the API key and secret key of the 'kubeadmin' user of the CKS cluster's creator's account. An attacker who's a member of the project can exploit this to impersonate and perform privileged actions that can result in complete compromise of the confidentiality, integrity, and availability of resources owned by the creator's account.\n\nCKS users are recommended to upgrade to version 4.19.3.0 or 4.20.1.0, which fixes this issue.Updating Existing Kubernetes Clusters in ProjectsA service account should be created for each project to provide limited access specifically for Kubernetes cluster providers and autoscaling. Follow the steps below to create a new service account, update the secret inside the cluster, and regenerate existing API and service keys:1. Create a New Service AccountCreate a new account using the role \"Project Kubernetes Service Role\" with the following details:\n\nAccount Name\nkubeadmin-<FIRST_EIGHT_CHARACTERS_OF_PROJECT_ID>\nFirst Name\nKubernetes\nLast Name\nService User\nAccount Type\n0 (Normal User)\nRole ID\n<ID_OF_SERVICE_ROLE>\n\n\n\n2. Add the Service Account to the ProjectAdd this account to the project where the Kubernetes cluster(s) are hosted.\n3. Generate API and Secret KeysGenerate API Key and Secret Key for the default user of this account.\n4. Update the CloudStack Secret in the Kubernetes ClusterCreate a temporary file `/tmp/cloud-config` with the following data:\n\u00a0\u00a0\u00a0api-url = <API_URL>  \u00a0 \u00a0  # For example: <MS_URL>/client/api\n\u00a0 api-key = <SERVICE_USER_API_KEY>\n\u00a0 secret-key = <SERVICE_USER_SECRET_KEY>\n\u00a0 project-id = <PROJECT_ID>\n\n\n\n\nDelete the existing secret using kubectl and Kubernetes cluster config:\n\u00a0\u00a0\u00a0./kubectl --kubeconfig kube.conf -n kube-system delete secret cloudstack-secret\n\n\n\n\nCreate a new secret using kubectl and Kubernetes cluster config:\n\u00a0 \u00a0 ./kubectl --kubeconfig kube.conf -n kube-system create secret generic cloudstack-secret --from-file=/tmp/cloud-config\n\n\n\n\nRemove the temporary file:\n\u00a0 \u00a0 rm /tmp/cloud-config5. Regenerate API and Secret KeysRegenerate the API and secret keys for the original user account that was used to create the Kubernetes cluster.",
          "lang": "en",
          "supportingMedia": [
            {
              "type": "text/html",
              "base64": false,
              "value": "When an Apache CloudStack user-account creates a CKS-based Kubernetes cluster in a project, the API key and the secret key of the 'kubeadmin' user of the caller account are used to create the secret config in the CKS-based Kubernetes cluster. A member of the project who can access the CKS-based Kubernetes cluster, can also access the API key and secret key of the 'kubeadmin' user of the CKS cluster's creator's account. An attacker who's a member of the project can exploit this to impersonate and perform privileged actions that can result in complete compromise of the confidentiality, integrity, and availability of resources owned by the creator's account.<br><br>CKS users are recommended to upgrade to version 4.19.3.0 or 4.20.1.0, which fixes this issue.<h3>Updating Existing Kubernetes Clusters in Projects</h3>A <b>service account</b> should be created for each project to provide limited access specifically for Kubernetes cluster providers and autoscaling. Follow the steps below to create a new service account, update the secret inside the cluster, and regenerate existing API and service keys:<h3>1. Create a New Service Account</h3><div>Create a new account using the role <b>\"Project Kubernetes Service Role\"</b> with the following details:</div><div><table><tbody><tr><td><b>Account Name</b><br></td><td>kubeadmin-&lt;FIRST_EIGHT_CHARACTERS_OF_PROJECT_ID&gt;<br></td></tr><tr><td><b>First Name</b><br></td><td>Kubernetes<br></td></tr><tr><td><b>Last Name</b><br></td><td>Service User<br></td></tr><tr><td><b>Account Type</b><br></td><td>0 (Normal User)<br></td></tr><tr><td><b>Role ID</b><br></td><td>&lt;ID_OF_SERVICE_ROLE&gt;<br></td></tr></tbody></table><br></div><h3>2. Add the Service Account to the Project</h3>Add this account to the <b>project</b> where the Kubernetes cluster(s) are hosted.<br><h3>3. Generate API and Secret Keys</h3>Generate <b>API Key</b> and <b>Secret Key</b> for the <i>default user</i> of this account.<br><h3>4. Update the CloudStack Secret in the Kubernetes Cluster</h3>Create a temporary file `/tmp/cloud-config` with the following data:<br>&nbsp;&nbsp;<tt>&nbsp;api-url = &lt;API_URL&gt;  &nbsp; &nbsp;  # For example: &lt;MS_URL&gt;/client/api<br>&nbsp; api-key = &lt;SERVICE_USER_API_KEY&gt;<br>&nbsp; secret-key = &lt;SERVICE_USER_SECRET_KEY&gt;<br></tt><div><tt>&nbsp; project-id = &lt;PROJECT_ID&gt;</tt></div><div><tt><br></tt></div>Delete the existing secret using kubectl and Kubernetes cluster config:<br><div>&nbsp;&nbsp;<tt>&nbsp;./kubectl --kubeconfig kube.conf -n kube-system delete secret cloudstack-secret</tt></div><div><tt><br></tt></div>Create a new secret using kubectl and Kubernetes cluster config:<br><div>&nbsp; &nbsp; ./kubectl --kubeconfig kube.conf -n kube-system create secret generic cloudstack-secret --from-file=/tmp/cloud-config</div><div><br></div>Remove the temporary file:<br>&nbsp; &nbsp; rm /tmp/cloud-config<h3>5. Regenerate API and Secret Keys</h3>Regenerate the API and secret keys for the <b>original user account</b> that was used to create the Kubernetes cluster.<br>"
            }
          ]
        }
      ],
      "references": [
        {
          "url": "https://cloudstack.apache.org/blog/cve-advisories-4.19.3.0-4.20.1.0/",
          "tags": [
            "vendor-advisory"
          ]
        },
        {
          "url": "https://www.shapeblue.com/shapeblue-security-advisory-cloudstack-4-19-3-0-and-4-20-1-0/",
          "tags": [
            "third-party-advisory"
          ]
        },
        {
          "url": "https://lists.apache.org/thread/y3qnwn59t8qggtdohv7k7vw39bgb3d60",
          "tags": [
            "mailing-list"
          ]
        }
      ],
      "metrics": [
        {
          "other": {
            "type": "Textual description of severity",
            "content": {
              "text": "critical"
            }
          }
        }
      ],
      "credits": [
        {
          "lang": "en",
          "value": "Wei Zhou (weizhou@apache.org)",
          "type": "finder"
        }
      ],
      "x_generator": {
        "engine": "Vulnogram 0.2.0"
      }
    }
  },
  "cveMetadata": {
    "cveId": "CVE-2025-26521",
    "assignerOrgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09",
    "serial": 1,
    "state": "PUBLISHED"
  },
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1"
}