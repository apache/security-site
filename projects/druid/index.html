<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta name="generator" content="Hugo 0.111.3">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Apache Druid security advisories </title>

  
  <meta name="description" content="Security information for Apache Druid"> 
  
  
  
  
  
  <meta name="robots" content="noindex">
  

  

  <meta name="author" content="">


  <meta property="og:title" content="Apache Druid security advisories" />
<meta property="og:description" content="Security information for Apache Druid" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://security.apache.org/projects/druid/" />

  




  
  
   <link href="/projects/druid/index.xml" rel="alternate" type="application/rss+xml" title="Apache Security Team" /> 

  <link rel="canonical" href="https://security.apache.org/projects/druid/">  

  <link href="/css/font.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.min.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.legenda.css" rel="stylesheet" type="text/css">
  <link href="/css/highlight.css" rel="stylesheet" type="text/css">
  <link href="/css/main.css" rel="stylesheet" type="text/css">
  

 <link href="/css/custom.css" rel="stylesheet" type="text/css">

  <script src="/js/jquery-2.1.4.min.js" type="text/javascript">
  </script>

  <script type="text/javascript" src="/js/tocbot.min.js"></script>
</head>


<body class="page-kube">
  <header> <div class="show-sm">
  <header class="site-header">
    <div class="nav-container">
      <a href="/" class="nav-brand">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
        </svg>
        Apache Security Team
      </a>
      <button class="nav-toggle" aria-label="Toggle navigation" onclick="document.querySelector('.nav-menu').classList.toggle('active')">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
      <ul class="nav-menu">
        <li><a href="/blog">Blog</a></li>
        <li><a href="/projects">Projects</a></li>
        <li><a href="/mailinglist">Mailing List</a></li>
        <li><a href="https://www.apache.org/licenses/">License</a></li>
        <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
        <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
        <li><a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy</a></li>
        <li><a href="https://www.apache.org">Apache</a></li>
      </ul>
    </div>
  </header>
 </header>
  <main>

<div id="hero" class="wrap">
  <h1>Apache Druid security advisories</h1>
    <p>Security information for Apache Druid</p>
</div>
<div id="project-box">
<div id="project">

 <h1 id="reporting">Reporting</h1>
<p>Do you want disclose a potential security issue for Apache Druid? You can read more about the projects&rsquo; security policy on their <a href="https://druid.apache.org/docs/latest/operations/security-overview.html">security page</a>, and email your report to the <a href="mailto:security@apache.org">Apache Security Team</a>.</p>
<h1 id="advisories">Advisories</h1>
<p class="bg-warning">This section is experimental: it provides advisories since 2023 and may lag behind the official CVE publications. It may also lack details found on the <a href="https://druid.apache.org/docs/latest/operations/security-overview.html">project security page</a>. If you have any feedback on how you would like this data to be provided, you are welcome to reach out on our public <a href="/mailinglist">mailinglist</a> or privately on <a href="mailto:security@apache.org">security@apache.org</a></p>
<h2 id="CVE-2021-25646">Authenticated users can override system configurations in their requests which allows them to execute arbitrary code.</h2>
<p>CVE-2021-25646 <a href="./CVE-2021-25646.cve.json">[CVE json]</a> <a href="./CVE-2021-25646.osv.json">[OSV json]</a></p>
<p><em>Last updated: 2021-01-29T19:09:31.597Z</em></p>
<h3 id="affected">Affected</h3>
<ul>
<li>Apache Druid from 0.20.0 and earlier through 0.20.0</li>
</ul>
<h3 id="description">Description</h3>
<p>Apache Druid includes the ability to execute user-provided JavaScript code embedded in various types of requests. This functionality is intended for use in high-trust environments, and is disabled by default. However, in Druid 0.20.0 and earlier, it is possible for an authenticated user to send a specially-crafted request that forces Druid to run user-provided JavaScript code for that request, regardless of server configuration. This can be leveraged to execute code on the target machine with the privileges of the Druid server process.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://lists.apache.org/thread.html/rfda8a3aa6ac06a80c5cbfdeae0fc85f88a5984e32ea05e6dda46f866%40%3Cdev.druid.apache.org%3E">https://lists.apache.org/thread.html/rfda8a3aa6ac06a80c5cbfdeae0fc85f88a5984e32ea05e6dda46f866%40%3Cdev.druid.apache.org%3E</a></li>
</ul>
<h3 id="credits">Credits</h3>
<ul>
<li>This issue was discovered by Litch1 from the Security Team of Alibaba Cloud.</li>
</ul>
<h2 id="CVE-2021-26919">Apache Druid Authenticated users can execute arbitrary code from malicious MySQL database systems.</h2>
<p>CVE-2021-26919 <a href="./CVE-2021-26919.cve.json">[CVE json]</a> <a href="./CVE-2021-26919.osv.json">[OSV json]</a></p>
<p><em>Last updated: 2021-03-30T07:47:52.941Z</em></p>
<h3 id="affected-1">Affected</h3>
<ul>
<li>Apache Druid from Apache Druid through 0.20.1</li>
</ul>
<h3 id="description-1">Description</h3>
<p>Apache Druid allows users to read data from other database systems using JDBC. This functionality is to allow trusted users with the proper permissions to set up lookups or submit ingestion tasks. The MySQL JDBC driver supports certain properties, which, if left unmitigated, can allow an attacker to execute arbitrary code from a hacker-controlled malicious MySQL server within Druid server processes.  This issue was addressed in Apache Druid 0.20.2</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://lists.apache.org/thread.html/rd87451fce34df54796e66321c40d743a68fb4553d72e7f6f0bc62ebd%40%3Cdev.druid.apache.org%3E">https://lists.apache.org/thread.html/rd87451fce34df54796e66321c40d743a68fb4553d72e7f6f0bc62ebd%40%3Cdev.druid.apache.org%3E</a></li>
</ul>
<h3 id="credits-1">Credits</h3>
<ul>
<li>This issue was discovered by fantasyC4t from the Ant FG Security Lab.</li>
</ul>
<h2 id="CVE-2021-26920">Apache Druid: The HTTP inputSource allows authenticated users to read data from other sources than intended</h2>
<p>CVE-2021-26920 <a href="./CVE-2021-26920.cve.json">[CVE json]</a> <a href="./CVE-2021-26920.osv.json">[OSV json]</a></p>
<p><em>Last updated: 2021-07-02T07:14:27.176Z</em></p>
<h3 id="affected-2">Affected</h3>
<ul>
<li>Apache Druid from Apache Druid through 0.20.2</li>
</ul>
<h3 id="description-2">Description</h3>
<p>In the Druid ingestion system, the InputSource is used for reading data from a certain data source. However, the HTTP InputSource allows authenticated users to read data from other sources than intended, such as the local file system, with the privileges of the Druid server process. This is not an elevation of privilege when users access Druid directly, since Druid also provides the Local InputSource, which allows the same level of access. But it is problematic when users interact with Druid indirectly through an application that allows users to specify the HTTP InputSource, but not the Local InputSource. In this case, users could bypass the application-level restriction by passing a file URL to the HTTP InputSource.</p>
<h3 id="references-2">References</h3>
<ul>
<li><a href="https://lists.apache.org/thread.html/r29e45561343cc5cf7d3290ee0b0e94e565faab19c20d022df9b5e29c%40%3Cdev.druid.apache.org%3E">https://lists.apache.org/thread.html/r29e45561343cc5cf7d3290ee0b0e94e565faab19c20d022df9b5e29c%40%3Cdev.druid.apache.org%3E</a></li>
</ul>
<h3 id="credits-2">Credits</h3>
<ul>
<li>This issue was discovered by chybeta from the Security Team of Alibaba Cloud.</li>
</ul>
<h2 id="CVE-2021-36749">Apache Druid: The HTTP inputSource allows authenticated users to read data from other sources than intended (incomplete fix of CVE-2021-26920)</h2>
<p>CVE-2021-36749 <a href="./CVE-2021-36749.cve.json">[CVE json]</a> <a href="./CVE-2021-36749.osv.json">[OSV json]</a></p>
<p><em>Last updated: 2021-09-23T23:08:21.915Z</em></p>
<h3 id="affected-3">Affected</h3>
<ul>
<li>Apache Druid from 0.21.1 and earlier through 0.21.1</li>
</ul>
<h3 id="description-3">Description</h3>
<p>In the Druid ingestion system, the InputSource is used for reading data from a certain data source. However, the HTTP InputSource allows authenticated users to read data from other sources than intended, such as the local file system, with the privileges of the Druid server process. This is not an elevation of privilege when users access Druid directly, since Druid also provides the Local InputSource, which allows the same level of access. But it is problematic when users interact with Druid indirectly through an application that allows users to specify the HTTP InputSource, but not the Local InputSource. In this case, users could bypass the application-level restriction by passing a file URL to the HTTP InputSource.</p>
<p>This issue was previously mentioned as being fixed in 0.21.0 as per CVE-2021-26920 but was not fixed in 0.21.0 or 0.21.1.</p>
<h3 id="references-3">References</h3>
<ul>
<li><a href="https://lists.apache.org/thread.html/rc9400a70d0ec5cdb8a3486fc5ddb0b5282961c0b63e764abfbcb9f5d%40%3Cdev.druid.apache.org%3E">https://lists.apache.org/thread.html/rc9400a70d0ec5cdb8a3486fc5ddb0b5282961c0b63e764abfbcb9f5d%40%3Cdev.druid.apache.org%3E</a></li>
</ul>
<h3 id="credits-3">Credits</h3>
<ul>
<li>This issue was originally discovered by chybeta from the Security Team of Alibaba Cloud.</li>
<li>ABKing and g0udan from the Security Team of Xiaomi discovered that it was still an issue after CVE-2021-26920.</li>
</ul>
<h2 id="CVE-2021-44791">Reflected XSS on certain HTTP endpoints</h2>
<p>CVE-2021-44791 <a href="./CVE-2021-44791.cve.json">[CVE json]</a> <a href="./CVE-2021-44791.osv.json">[OSV json]</a></p>
<p><em>Last updated: 2022-07-07T18:29:34.319Z</em></p>
<h3 id="affected-4">Affected</h3>
<ul>
<li>Apache Druid from Apache Druid through 0.22.1</li>
</ul>
<h3 id="description-4">Description</h3>
<p>In Apache Druid 0.22.1 and earlier, certain specially-crafted links result in unescaped URL parameters being sent back in HTML responses. This makes it possible to execute reflected XSS attacks.</p>
<h3 id="references-4">References</h3>
<ul>
<li><a href="https://lists.apache.org/thread/lh2kcl4j45q7xj4w6rqf6kwf0mvyp2o6">https://lists.apache.org/thread/lh2kcl4j45q7xj4w6rqf6kwf0mvyp2o6</a></li>
</ul>
<h3 id="credits-4">Credits</h3>
<ul>
<li>This issue was discovered by DangKhai from Viettel Cyber Security</li>
</ul>
<h2 id="CVE-2022-28889">Clickjacking in the web console</h2>
<p>CVE-2022-28889 <a href="./CVE-2022-28889.cve.json">[CVE json]</a> <a href="./CVE-2022-28889.osv.json">[OSV json]</a></p>
<p><em>Last updated: 2022-07-07T18:30:27.570Z</em></p>
<h3 id="affected-5">Affected</h3>
<ul>
<li>Apache Druid from unspecified through 0.22.1</li>
</ul>
<h3 id="description-5">Description</h3>
<p>In Apache Druid 0.22.1 and earlier, the server did not set appropriate headers to prevent clickjacking. Druid 0.23.0 and later prevent clickjacking using the Content-Security-Policy header.</p>
<h3 id="references-5">References</h3>
<ul>
<li><a href="https://lists.apache.org/thread/t3nsq4crdr8wqgmj721d2wg6pf26s5cw">https://lists.apache.org/thread/t3nsq4crdr8wqgmj721d2wg6pf26s5cw</a></li>
</ul>
<h2 id="CVE-2024-45384">Padding oracle in druid-pac4j extension that allows an attacker to manipulate a pac4j session cookie via Padding Oracle Attack</h2>
<p>CVE-2024-45384 <a href="./CVE-2024-45384.cve.json">[CVE json]</a> <a href="./CVE-2024-45384.osv.json">[OSV json]</a></p>
<p><em>Last updated: 2024-09-17T17:58:14.680Z</em></p>
<h3 id="affected-6">Affected</h3>
<ul>
<li>Apache Druid from 0.18.0 through 30.0.0</li>
</ul>
<h3 id="description-6">Description</h3>
<p>Padding Oracle vulnerability in Apache Druid extension, druid-pac4j.<br>This could allow an attacker to manipulate a pac4j session cookie.<br><br></p><p>This issue affects Apache Druid versions 0.18.0 through 30.0.0.<br>Since the druid-pac4j extension is optional and disabled by default, Druid installations not using the druid-pac4j extension are not affected by this vulnerability.<br></p><p></p><br>While we are not aware of a way to meaningfully exploit this flaw, we 
nevertheless recommend upgrading to version 30.0.1 or higher which fixes the issue<br>and ensuring you have a strong 
druid.auth.pac4j.cookiePassphrase as a precaution.<br><p></p>
<h3 id="references-6">References</h3>
<ul>
<li><a href="https://lists.apache.org/thread/gr94fnp574plb50lsp8jw4smvgv1lbz1">https://lists.apache.org/thread/gr94fnp574plb50lsp8jw4smvgv1lbz1</a></li>
</ul>
<h3 id="credits-5">Credits</h3>
<ul>
<li>mr-n30 (reporter)</li>
</ul>
<h2 id="CVE-2024-45537">Users can provide MySQL JDBC properties not on allow list</h2>
<p>CVE-2024-45537 <a href="./CVE-2024-45537.cve.json">[CVE json]</a> <a href="./CVE-2024-45537.osv.json">[OSV json]</a></p>
<p><em>Last updated: 2024-09-19T09:29:22.203Z</em></p>
<h3 id="affected-7">Affected</h3>
<ul>
<li>Apache Druid through 30.0.0</li>
</ul>
<h3 id="description-7">Description</h3>
<div>Apache Druid allows users with certain permissions to read data from other database systems using JDBC. This functionality allows trusted users to set up Druid lookups or run ingestion tasks. Druid also allows administrators to configure a list of allowed properties that users are able to provide for their JDBC connections. By default, this allowed properties list restricts users to TLS-related properties only. However, when configuration a MySQL JDBC connection, users can use a particularly-crafted JDBC connection string to provide properties that are not on this allow list.</div><div><br></div>Users without the permission to configure JDBC connections are not able to exploit this vulnerability.<br>CVE-2021-26919 describes a similar vulnerability which was partially addressed in Apache Druid 0.20.2.<br><div><br></div><div><br></div><div>This issue is fixed in Apache Druid 30.0.1.</div><br>
<h3 id="references-7">References</h3>
<ul>
<li><a href="https://lists.apache.org/thread/2ovx1t77y6tlkhk5b42clp4vwo4c8cjv">https://lists.apache.org/thread/2ovx1t77y6tlkhk5b42clp4vwo4c8cjv</a></li>
</ul>
<h3 id="credits-6">Credits</h3>
<ul>
<li>L0ne1y (finder)</li>
</ul>

  
</div>
</div>
</main>
  <footer> 
    <footer id="footer">
    <p>&copy; The Apache Software Foundation. Built using the <a href="https://github.com/jeblister/kube" target="_blank" rel="noopener noreferrer">kube Theme for Hugo</a>. Apache and the Apache feather logo are either registered trademarks or trademarks of The Apache Software Foundation in the United States and other countries.</p>
  </footer>
 
</footer>


  <script src="/js/kube.js" type="text/javascript">
  </script>
  <script src="/js/kube.legenda.js" type="text/javascript">
  </script>
  <script src="/js/main.js" type="text/javascript">
  </script>
</body>

</html>
