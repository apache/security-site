<html>
<head>
  <meta charset="utf-8"/>
  <script src="echarts.min.js"></script>
  <!-- TODO perhaps replace -->
  <script src="jquery.min.js "></script>
<style>
body {
  font-family: sans-serif;
}
#intro {
  margin-left: 2em;
  margin-right: 2em;
}
</style>
</head>
<body>
  <div id="intro">
  <h1>Apache Ecosystem Graph</h1>
  This page shows Apache artifacts that publish SBOMs, and their
  dependency relationships. While this is a somewhat superficial
  showcase, you are encouraged to
  <a href="https://cwiki.apache.org/confluence/display/SECURITY/Software+Bill+of+Materials+SBOM">publish SBOMs for your project</a>
  and <a href="https://github.com/apache/security-site/tree/sboms">get them included here</a>.
  </div>
  <div id="main" style="width: 100%; height: 90%"></div>
  <script>
var option;
const myChart = echarts.init(document.getElementById('main'))
myChart.showLoading();
$.get('ecosystem.json', function (webkitDep) {
  console.log('loaded', webkitDep);
  myChart.hideLoading();
  option = {
    legend: {
      data: webkitDep.categories,
      //data: [ 'foo', 'bar' ],
      right: 10,
      top: 20,
      bottom: 20
    },
    series: [
      {
        type: 'graph',
        layout: 'force',
	label: {
	  position: 'right',
	  formatter: '{b}'
	},
        edgeSymbol: ['circle', 'arrow'],
        categories: webkitDep.categoryObjects,
        data: webkitDep.nodes.map(function (node, idx) {
          node.id = idx;
          return node;
        }),
	draggable: true,
        edges: webkitDep.links,
        force: {
          edgeLength: 15,
          repulsion: 20,
          gravity: 0.2
        },
      }
    ]
  };
  //myChart.on('click', function(params) {
  //  alert(params.name);
  //});
  myChart.setOption(option);
});
  </script>
</body>
</html>
