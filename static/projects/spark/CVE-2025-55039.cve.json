{
  "containers": {
    "cna": {
      "providerMetadata": {
        "orgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09"
      },
      "title": "RPC encryption defaults to unauthenticated AES-CTR mode, enabling man-in-the-middle ciphertext modification attacks",
      "problemTypes": [
        {
          "descriptions": [
            {
              "description": "CWE-347 Improper Verification of Cryptographic Signature",
              "lang": "en",
              "cweId": "CWE-347",
              "type": "CWE"
            }
          ]
        },
        {
          "descriptions": [
            {
              "description": "CWE-326 Inadequate Encryption Strength",
              "lang": "en",
              "cweId": "CWE-326",
              "type": "CWE"
            }
          ]
        }
      ],
      "source": {
        "discovery": "UNKNOWN"
      },
      "affected": [
        {
          "vendor": "Apache Software Foundation",
          "product": "Apache Spark",
          "collectionURL": "https://repo.maven.apache.org/maven2",
          "packageName": "org.apache.spark:spark-network-common_2.13",
          "versions": [
            {
              "status": "affected",
              "version": "3.5.0",
              "lessThan": "3.5.2",
              "versionType": "semver"
            },
            {
              "status": "affected",
              "version": "0",
              "lessThan": "3.4.4",
              "versionType": "semver"
            }
          ],
          "defaultStatus": "unaffected"
        },
        {
          "vendor": "Apache Software Foundation",
          "product": "Apache Spark",
          "collectionURL": "https://repo.maven.apache.org/maven2",
          "packageName": "org.apache.spark:spark-network-common_2.12",
          "versions": [
            {
              "status": "affected",
              "version": "3.5.0",
              "lessThan": "3.5.2",
              "versionType": "semver"
            },
            {
              "status": "affected",
              "version": "0",
              "lessThan": "3.4.4",
              "versionType": "semver"
            }
          ],
          "defaultStatus": "unaffected"
        }
      ],
      "descriptions": [
        {
          "value": "This issue affects Apache Spark versions before  3.4.4,\u00a03.5.2 and 4.0.0.\n\n\n\nApache Spark versions before 4.0.0, 3.5.2 and 3.4.4 use an insecure default network encryption cipher for RPC communication between nodes.\n\nWhen spark.network.crypto.enabled is set to true (it is set to false by default), but spark.network.crypto.cipher is not explicitly configured, Spark defaults to AES in CTR mode (AES/CTR/NoPadding), which provides encryption without authentication.\n\nThis vulnerability allows a man-in-the-middle attacker to modify encrypted RPC traffic undetected by flipping bits in ciphertext, potentially compromising heartbeat messages or application data and affecting the integrity of Spark workflows.\n\n\nTo mitigate this issue, users should either configure spark.network.crypto.cipher to AES/GCM/NoPadding to enable authenticated encryption or\n\nenable SSL encryption by setting spark.ssl.enabled to true, which provides stronger transport security.",
          "lang": "en",
          "supportingMedia": [
            {
              "type": "text/html",
              "base64": false,
              "value": "<p>This issue affects Apache Spark versions before  3.4.4,&nbsp;3.5.2 and 4.0.0.</p><p></p>Apache Spark versions before 4.0.0, 3.5.2 and 3.4.4 use an insecure default network encryption cipher for RPC communication between nodes.<p></p><p>When <code>spark.network.crypto.enabled</code> is set to true (it is set to false by default), but <code>spark.network.crypto.cipher</code> is not explicitly configured, Spark defaults to AES in CTR mode (<code>AES/CTR/NoPadding</code>), which provides encryption without authentication.</p><p>This vulnerability allows a man-in-the-middle attacker to modify encrypted RPC traffic undetected by flipping bits in ciphertext, potentially compromising heartbeat messages or application data and affecting the integrity of Spark workflows.<br></p><p>To mitigate this issue, users should either configure <code>spark.network.crypto.cipher</code> to <code>AES/GCM/NoPadding</code> to enable authenticated encryption or</p><p>enable SSL encryption by setting <code>spark.ssl.enabled</code> to true, which provides stronger transport security.</p>"
            }
          ]
        }
      ],
      "references": [
        {
          "url": "https://lists.apache.org/thread/zrgyy9l85nm2c7vk36vr7bkyorg3w4qq",
          "tags": [
            "vendor-advisory"
          ]
        }
      ],
      "metrics": [
        {
          "other": {
            "type": "Textual description of severity",
            "content": {
              "text": "moderate"
            }
          }
        }
      ],
      "x_generator": {
        "engine": "Vulnogram 0.2.0"
      }
    }
  },
  "cveMetadata": {
    "cveId": "CVE-2025-55039",
    "assignerOrgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09",
    "serial": 1,
    "state": "PUBLISHED"
  },
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1"
}